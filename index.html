<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Valentine Adventure ‚ù§Ô∏è</title>
<style>
    body {
        margin: 0;
        overflow: hidden;
        font-family: 'Arial', sans-serif;
        background: #111;
    }

    canvas {
        display: block;
        background: url('images/bg.jpg') no-repeat center center;
        background-size: cover;
    }

    #puzzleModal {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.8);
        display: none;
        align-items: center;
        justify-content: center;
        color: white;
        text-align: center;
    }

    .puzzleBox {
        background: #ff4f81;
        padding: 30px;
        border-radius: 15px;
        width: 300px;
    }

    input {
        padding: 10px;
        border-radius: 8px;
        border: none;
        width: 80%;
        margin-top: 10px;
    }

    button {
        margin-top: 15px;
        padding: 10px 15px;
        border: none;
        border-radius: 8px;
        background: white;
        cursor: pointer;
        font-weight: bold;
    }

    #messageScreen {
        position: fixed;
        inset: 0;
        background: linear-gradient(to bottom right, #ff4f81, #ff9a9e);
        display: none;
        color: white;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        font-size: 2rem;
    }
</style>
</head>
<body>

<canvas id="gameCanvas"></canvas>

<div id="puzzleModal">
    <div class="puzzleBox">
        <h2>üíå Love Puzzle</h2>
        <p>What is our anniversary date?</p>
        <input id="answerInput" placeholder="MM/DD/YYYY">
        <br>
        <button onclick="checkAnswer()">Unlock ‚ù§Ô∏è</button>
        <p id="errorMsg" style="color:yellow;"></p>
    </div>
</div>

<div id="messageScreen">
    <h1>You Reached the End üíñ</h1>
    <p>I Love You So Much ‚ù§Ô∏è</p>
</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let gravity = 0.8;
let keysCollected = 0;

const playerImg = new Image();
playerImg.src = "images/player.png"; // replace

const envelopeImg = new Image();
envelopeImg.src = "images/envelope.png"; // replace

const gateImg = new Image();
gateImg.src = "images/gate.png"; // replace

let player = {
    x: 100,
    y: 300,
    width: 50,
    height: 50,
    dx: 0,
    dy: 0,
    jumping: false
};

let keys = {};
let envelopes = [
    {x: 600, y: 300, solved: false},
    {x: 1200, y: 300, solved: false}
];

let gate = {
    x: 1600,
    y: 280,
    width: 80,
    height: 120
};

let finishLine = 2000;

document.addEventListener("keydown", e => keys[e.code] = true);
document.addEventListener("keyup", e => keys[e.code] = false);

function update() {

    if (keys["ArrowRight"]) player.dx = 5;
    else if (keys["ArrowLeft"]) player.dx = -5;
    else player.dx = 0;

    if (keys["Space"] && !player.jumping) {
        player.dy = -15;
        player.jumping = true;
    }

    player.dy += gravity;
    player.x += player.dx;
    player.y += player.dy;

    if (player.y > 300) {
        player.y = 300;
        player.jumping = false;
    }

    envelopes.forEach(env => {
        if (!env.solved &&
            player.x < env.x + 50 &&
            player.x + player.width > env.x &&
            player.y < env.y + 50 &&
            player.y + player.height > env.y) {

            openPuzzle(env);
        }
    });

    if (keysCollected < envelopes.length) {
        if (player.x + player.width > gate.x) {
            player.x = gate.x - player.width;
        }
    }

    if (player.x > finishLine) {
        document.getElementById("messageScreen").style.display = "flex";
    }
}

function draw() {
    ctx.clearRect(0,0,canvas.width,canvas.height);

    ctx.drawImage(playerImg, player.x, player.y, player.width, player.height);

    envelopes.forEach(env => {
        if (!env.solved)
            ctx.drawImage(envelopeImg, env.x, env.y, 50, 50);
    });

    ctx.drawImage(gateImg, gate.x, gate.y, gate.width, gate.height);

    ctx.fillStyle = "white";
    ctx.fillText("Keys: " + keysCollected, 20, 30);
}

function gameLoop() {
    update();
    draw();
    requestAnimationFrame(gameLoop);
}

gameLoop();

let currentEnvelope = null;

function openPuzzle(env) {
    currentEnvelope = env;
    document.getElementById("puzzleModal").style.display = "flex";
}

function checkAnswer() {
    let input = document.getElementById("answerInput").value;
    
    if (input === "02/14/2023") { // change to your real date
        currentEnvelope.solved = true;
        keysCollected++;
        document.getElementById("puzzleModal").style.display = "none";
        document.getElementById("errorMsg").innerText = "";
        document.getElementById("answerInput").value = "";
    } else {
        document.getElementById("errorMsg").innerText = "Wrong answer üíî Try again!";
    }
}
</script>

</body>
</html>
