<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Valentine Catcher</title>
<style>
body { margin: 0; overflow: hidden; font-family: sans-serif; background: #ffe6ea; touch-action: none; }
#game-area { position: relative; width: 100vw; height: 100vh; overflow: hidden; }
#player { position: absolute; bottom: 20px; width: 80px; height: 80px; background: url('basket.png') no-repeat center center/contain; transform: translateX(-50%); pointer-events: none; z-index: 10; }
.item { position: absolute; width: 50px; height: 50px; background-repeat: no-repeat; background-position: center; background-size: contain; will-change: top; }
#ui { position: absolute; top: 10px; left: 10px; font-size: 24px; color: #d6336c; font-weight: bold; z-index: 100; pointer-events: none; }
#start-screen, #game-over { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 230, 234, 0.95); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 200; }
h1 { color: #d6336c; font-size: 40px; text-align: center; margin-bottom: 20px; }
button { padding: 15px 40px; font-size: 24px; background: #ff3366; color: white; border: none; border-radius: 50px; cursor: pointer; box-shadow: 0 4px 0 #c2185b; }
button:active { transform: translateY(4px); box-shadow: none; }
#game-over { display: none; }
</style>
</head>
<body>

<div id="game-area">
    <div id="ui">Score: <span id="score">0</span></div>
    <div id="player"></div>
    <div id="start-screen">
        <h1>Valentine Catcher</h1>
        <button onclick="startGame()">Play</button>
    </div>
    <div id="game-over">
        <h1>Game Over!</h1>
        <h2 id="final-score">Score: 0</h2>
        <button onclick="location.reload()">Try Again</button>
    </div>
</div>

<script>
const player = document.getElementById('player');
const gameArea = document.getElementById('game-area');
const scoreEl = document.getElementById('score');
const startScreen = document.getElementById('start-screen');
const gameOverScreen = document.getElementById('game-over');
const finalScoreEl = document.getElementById('final-score');

let score = 0;
let isActive = false;
let gameLoop;
let spawnLoop;
let items = [];
let speedMultiplier = 1;
let playerX = window.innerWidth / 2;

const assets = {
    good: ['rose.png', 'letter.png', 'chocolate.png'],
    bad: ['broken.png'] 
};

function updatePlayerPos() {
    player.style.left = playerX + 'px';
}
updatePlayerPos();

document.addEventListener('mousemove', (e) => {
    if (!isActive) return;
    playerX = e.clientX;
    updatePlayerPos();
});

document.addEventListener('touchmove', (e) => {
    if (!isActive) return;
    playerX = e.touches[0].clientX;
    updatePlayerPos();
}, { passive: false });

function createItem() {
    const el = document.createElement('div');
    el.classList.add('item');
    const isBad = Math.random() > 0.75;
    const type = isBad ? 'bad' : 'good';
    const imgList = assets[type];
    const img = imgList[Math.floor(Math.random() * imgList.length)];
    
    el.style.backgroundImage = `url('${img}')`;
    el.style.left = Math.random() * (window.innerWidth - 50) + 'px';
    el.style.top = '-60px';
    el.dataset.type = type;
    el.dataset.speed = (Math.random() * 3 + 3) * speedMultiplier;
    
    gameArea.appendChild(el);
    items.push({ el: el, y: -60, speed: parseFloat(el.dataset.speed), type: type });
}

function startGame() {
    startScreen.style.display = 'none';
    isActive = true;
    score = 0;
    speedMultiplier = 1;
    scoreEl.innerText = '0';
    
    player.style.backgroundImage = "url('basket.png')";
    if (!player.style.backgroundImage.includes('url')) {
        player.style.backgroundColor = '#ff3366';
        player.style.borderRadius = '10px';
    }

    spawnLoop = setInterval(createItem, 800);
    gameLoop = requestAnimationFrame(update);
}

function endGame() {
    isActive = false;
    clearInterval(spawnLoop);
    cancelAnimationFrame(gameLoop);
    gameOverScreen.style.display = 'flex';
    finalScoreEl.innerText = 'Score: ' + score;
}

function update() {
    if (!isActive) return;

    for (let i = items.length - 1; i >= 0; i--) {
        const item = items[i];
        item.y += item.speed;
        item.el.style.top = item.y + 'px';

        const pRect = player.getBoundingClientRect();
        const iRect = item.el.getBoundingClientRect();

        if (
            iRect.left < pRect.right &&
            iRect.right > pRect.left &&
            iRect.bottom > pRect.top &&
            iRect.top < pRect.bottom
        ) {
            if (item.type === 'bad') {
                endGame();
                return;
            } else {
                score += 10;
                scoreEl.innerText = score;
                speedMultiplier += 0.02;
                item.el.remove();
                items.splice(i, 1);
            }
        } else if (item.y > window.innerHeight) {
            item.el.remove();
            items.splice(i, 1);
        }
    }

    gameLoop = requestAnimationFrame(update);
}
</script>
</body>
</html>
